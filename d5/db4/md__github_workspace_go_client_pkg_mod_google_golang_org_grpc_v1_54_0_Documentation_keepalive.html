<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ResilientDB: Keepalive</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ResilientDB<span id="projectnumber">&#160;v1.3.1</span>
   </div>
   <div id="projectbrief">NexRes</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d5/db4/md__github_workspace_go_client_pkg_mod_google_golang_org_grpc_v1_54_0_Documentation_keepalive.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Keepalive </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>gRPC sends http2 pings on the transport to detect if the connection is down. If the ping is not acknowledged by the other side within a certain period, the connection will be closed. Note that pings are only necessary when there's no activity on the connection.</p>
<p>For how to configure keepalive, see <a href="https://godoc.org/google.golang.org/grpc/keepalive">https://godoc.org/google.golang.org/grpc/keepalive</a> for the options.</p>
<h1><a class="anchor" id="autotoc_md90"></a>
Why do I need this?</h1>
<p>Keepalive can be useful to detect TCP level connection failures. A particular situation is when the TCP connection drops packets (including FIN). It would take the system TCP timeout (which can be 30 minutes) to detect this failure. Keepalive would allow gRPC to detect this failure much sooner.</p>
<p>Another usage is (as the name suggests) to keep the connection alive. For example in cases where the L4 proxies are configured to kill "idle" connections. Sending pings would make the connections not "idle".</p>
<h1><a class="anchor" id="autotoc_md91"></a>
What should I set?</h1>
<p>It should be sufficient for most users to set <a href="https://godoc.org/google.golang.org/grpc/keepalive">client parameters</a> as a <a href="https://godoc.org/google.golang.org/grpc#WithKeepaliveParams">dial option</a>.</p>
<h1><a class="anchor" id="autotoc_md92"></a>
What will happen?</h1>
<p>(The behavior described here is specific for gRPC-go, it might be slightly different in other languages.)</p>
<p>When there's no activity on a connection (note that an ongoing stream results in <b>no activity</b> when there's no message being sent), after <code>Time</code>, a ping will be sent by the client and the server will send a ping ack when it gets the ping. Client will wait for <code>Timeout</code>, and check if there's any activity on the connection during this period (a ping ack is an activity).</p>
<h1><a class="anchor" id="autotoc_md93"></a>
What about server side?</h1>
<p>Server has similar <code>Time</code> and <code>Timeout</code> settings as client. Server can also configure connection max-age. See <a href="https://godoc.org/google.golang.org/grpc/keepalive#ServerParameters">server parameters</a> for details.</p>
<h2><a class="anchor" id="autotoc_md94"></a>
Enforcement policy</h2>
<p><a href="https://godoc.org/google.golang.org/grpc/keepalive#EnforcementPolicy">Enforcement policy</a> is a special setting on server side to protect server from malicious or misbehaving clients.</p>
<p>Server sends GOAWAY with ENHANCE_YOUR_CALM and close the connection when bad behaviors are detected:</p><ul>
<li>Client sends too frequent pings</li>
<li>Client sends pings when there's no stream and this is disallowed by server config </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
